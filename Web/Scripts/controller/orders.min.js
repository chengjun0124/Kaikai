app.controller("orders",["$scope","orderAPIService","routeService","companyAPIService","dialogService","$location",function(n,t,i,r,u,f){function e(){t.getOrders(n.paginationConf.currentPage,n.paginationConf.itemsPerPage,n.searchParam).then(function(t){n.paginationConf.totalItems=t.data.recordCount;n.orders=t.data.orders})}n.paginationConf={currentPage:1,itemsPerPage:20};n.searchParam={};n.selectedCompany=null;n.companies=null;n.orders=null;r.getCompanyOptions().then(function(t){n.companies=t.data});n.refreshOrders=function(){e()};n.search=function(){n.paginationConf.currentPage=1;e()};n.delete=function(){var n=[];if($("[name='chk_order_id']:checked").each(function(t,i){n.push($(i).val())}),n.length==0){u.showMention(1,"请勾选要删除的订单");return}u.showMention(2,"确定要删除选中的订单吗？",null,function(){t.deleteOrders(n).then(function(){$("#chk_all")[0].checked=!1;e()})})};n.sync=function(){var t=[];if($("[name='chk_order_id']").each(function(i,r){r.checked&&t.push(n.orders[i])}),t.length==0){u.showMention(1,"请勾选要同步的订单");return}u.showSycnOrderDetail(t)};n.updatebatch=function(){var i=[];if($("[name='chk_order_id']").each(function(t,r){r.checked&&i.push(n.orders[t])}),i.length==0){u.showMention(1,"请勾选要保存的订单");return}u.showMention(2,"确定要保存选中的订单吗？",null,function(){t.updateOrderDetailsBatch(i).then(function(){u.showMention(1,"保存明细成功")})})};n.detail=function(n){window.open(f.$$absUrl.replace("orders","order_edit/"+n))};n.$watch("paginationConf.currentPage + paginationConf.itemsPerPage",function(){($("#chk_all")[0].checked=!1,n.paginationConf.currentPage!=0)&&e()});n.changeCompany=function(){var i,t;for(n.selectedCompany=null,i=$("#sel_company").val(),t=0;t<n.companies.length;t++)if(n.companies[t].value==i){n.selectedCompany=n.companies[t];return}};n.selectAll=function(){var n=$("#chk_all")[0].checked;$("[name='chk_order_id']").each(function(t,i){i.checked=n})}}]);