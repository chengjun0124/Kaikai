app.directive("validateClick",["$rootScope",function(n){return{scope:{validateClick:"&",panel:"@"},link:function(t,i){i.on("click",function(){var w,c,v,b,k,u;$(".invalid_msg").text("");var o,e=[],d,i,s,f,h,y,r=":::",p,l,a,g,nt,tt,it,rt;for(o=t.panel!=null&&t.panel!=undefined?$("#"+t.panel+" [validation]"):$("[validation]"),u=0;u<o.length;u++)for(d=$(o[u]).attr("validation").split("|||"),s=$(o[u]).attr("fieldName"),h=$(o[u]).attr("mentionId"),f=$(o[u]).val(),w=0;w<d.length;w++){if(i=d[w],i=="required")if(o[u].tagName.toLowerCase()=="select"){if(o[u].selectedIndex==0){e.push({message:"请选择"+s,mentionId:h});break}}else if(f.trim().length==0){e.push({message:"请输入"+s,mentionId:h});break}if(f.length>0){if(i.indexOf("pattern"+r)==0&&(y=new RegExp(i.split(r)[1]),!y.test(f))){e.push({message:s+i.split(r)[2],mentionId:h});break}if(i.indexOf("minlengh"+r)==0&&(g=parseInt(i.split(r)[1]),f.length<g)){e.push({message:s+"必须大于"+g+"个字符",mentionId:h});break}if(i.indexOf("number"+r)==0)if(p=i.split(r)[1],p=="0"){if(!/^\d+$/.test(f)){e.push({message:s+"必须是整数",mentionId:h});break}}else if(y=new RegExp("^\\d+(.\\d{1,"+p+"}){0,1}$"),!y.test(f)){e.push({message:s+"必须是数字，且最多包含"+p+"位小数",mentionId:h});break}if(i.indexOf("range"+r)==0&&(l=i.split(r)[1].split("-")[0],a=i.split(r)[1].split("-")[1],l=parseFloat(l),a=parseFloat(a),f=parseFloat(f),f<l||f>a)){e.push({message:s+"必须在"+l+"-"+a+"之间",mentionId:h});break}}if(i.indexOf("compare"+r)==0&&(nt=$("#"+i.split(r)[1]).val(),tt=i.split(r)[2],it=i.split(r)[3]=="true"?!0:!1,rt=i.split(r)[4],(it||f.length>0)&&tt=="equal"&&f!=nt)){e.push({message:s+"和"+rt+"必须相等",mentionId:h});break}if(i.indexOf("oneisrequired"+r)==0){if(c=!1,c=$(o[u]).attr("type")=="checkbox"?o[u].checked:f.trim().length>0,!c)for(v=i.split(r),b=1;b<v.length-1;b++)if(k=$("#"+v[b]),k.attr("type")=="checkbox"){if(k[0].checked){c=!0;break}}else if(k.val().trim().length>0){c=!0;break}if(!c){e.push({message:s+"和"+v[v.length-1]+"至少填写一个",mentionId:h});break}}}for(u=0;u<e.length;u++)$("#"+e[u].mentionId).text(e[u].message);e.length==0&&(t.validateClick(),n.$apply())})}}}]);app.directive("enter",[function(){return{scope:{enter:"@"},link:function(n,t){t.keyup(function(n){var i,u,r,f;if(n.keyCode==13){for(i=$("input:enabled,textarea:enabled,select:enabled"),r=0;r<i.length;r++)if(i[r]==t[0]){u=r+1;break}if(n.altKey){for(r=u;r<i.length;r++)if(i[r].getAttribute("type")=="button"){i[r].focus();i[r].click();break}}else f=i[u].getAttribute("type"),i[u].focus(),f=="button"?i[u].click():f=="text"&&i[u].select()}})}}}]);app.directive("tmPagination",[function(){return{restrict:"EA",template:'<div class="page-list"><ul class="pagination" ng-show="conf.totalItems > 0"><li ng-class="{disabled: conf.currentPage == 1}" ng-click="prevPage()"><span>&laquo;<\/span><\/li><li ng-repeat="item in pageList track by $index" ng-class="{active: item == conf.currentPage, separate: item == \'...\'}" ng-click="changeCurrentPage(item)"><span>{{ item }}<\/span><\/li><li ng-class="{disabled: conf.currentPage == conf.numberOfPages}" ng-click="nextPage()"><span>&raquo;<\/span><\/li><\/ul><div class="page-total" ng-show="conf.totalItems > 0">第<input type="text" ng-model="jumpPageNum"  ng-keyup="jumpToPage($event)"/>页 每页<select ng-model="conf.itemsPerPage" ng-options="option for option in conf.perPageOptions " ng-change="changeItemsPerPage()"><\/select>/共<strong>{{ conf.totalItems }}<\/strong>条<\/div><div class="no-items" ng-show="conf.totalItems <= 0">暂无数据<\/div><\/div>',replace:!0,scope:{conf:"="},link:function(n){function t(){var r,u,t,i;for(n.conf.currentPage=parseInt(n.conf.currentPage)?parseInt(n.conf.currentPage):1,n.conf.totalItems=parseInt(n.conf.totalItems),n.conf.rememberPerPage?(parseInt(localStorage[n.conf.rememberPerPage])||(localStorage[n.conf.rememberPerPage]=parseInt(n.conf.itemsPerPage)?parseInt(n.conf.itemsPerPage):15),n.conf.itemsPerPage=parseInt(localStorage[n.conf.rememberPerPage])):n.conf.itemsPerPage=parseInt(n.conf.itemsPerPage)?parseInt(n.conf.itemsPerPage):15,n.conf.numberOfPages=Math.ceil(n.conf.totalItems/n.conf.itemsPerPage),n.conf.currentPage<1&&(n.conf.currentPage=1),n.conf.currentPage>n.conf.numberOfPages&&(n.conf.currentPage=n.conf.numberOfPages),n.jumpPageNum=n.conf.currentPage,r=n.conf.perPageOptions.length,t=0;t<r;t++)n.conf.perPageOptions[t]==n.conf.itemsPerPage&&(u=!0);if(u||n.conf.perPageOptions.push(n.conf.itemsPerPage),n.conf.perPageOptions.sort(function(n,t){return n-t}),n.pageList=[],n.conf.numberOfPages<=n.conf.pagesLength)for(t=1;t<=n.conf.numberOfPages;t++)n.pageList.push(t);else if(i=(n.conf.pagesLength-1)/2,n.conf.currentPage<=i){for(t=1;t<=i+1;t++)n.pageList.push(t);n.pageList.push("...");n.pageList.push(n.conf.numberOfPages)}else if(n.conf.currentPage>n.conf.numberOfPages-i){for(n.pageList.push(1),n.pageList.push("..."),t=i+1;t>=1;t--)n.pageList.push(n.conf.numberOfPages-t);n.pageList.push(n.conf.numberOfPages)}else{for(n.pageList.push(1),n.pageList.push("..."),t=Math.ceil(i/2);t>=1;t--)n.pageList.push(n.conf.currentPage-t);for(n.pageList.push(n.conf.currentPage),t=1;t<=i/2;t++)n.pageList.push(n.conf.currentPage+t);n.pageList.push("...");n.pageList.push(n.conf.numberOfPages)}n.conf.onChange&&n.conf.onChange();n.$parent.conf=n.conf}n.changeCurrentPage=function(t){t!="..."&&(n.conf.currentPage=t)};n.conf.pagesLength=parseInt(n.conf.pagesLength)?parseInt(n.conf.pagesLength):9;n.conf.pagesLength%2==0&&(n.conf.pagesLength=n.conf.pagesLength-1);n.conf.perPageOptions||(n.conf.perPageOptions=[10,15,20,30,50]);n.prevPage=function(){n.conf.currentPage>1&&(n.conf.currentPage-=1)};n.nextPage=function(){n.conf.currentPage<n.conf.numberOfPages&&(n.conf.currentPage+=1)};n.jumpToPage=function(){n.jumpPageNum=n.jumpPageNum.replace(/[^0-9]/g,"");n.jumpPageNum!==""&&(n.conf.currentPage=n.jumpPageNum)};n.changeItemsPerPage=function(){n.conf.rememberPerPage&&localStorage.removeItem(n.conf.rememberPerPage)};n.$watch(function(){var t=n.conf.currentPage+" "+n.conf.totalItems+" ";return t+(n.conf.rememberPerPage?localStorage[n.conf.rememberPerPage]?localStorage[n.conf.rememberPerPage]:n.conf.itemsPerPage:n.conf.itemsPerPage)},t)}}}]);app.directive("customEnter",[function(){return{scope:{customEnter:"&"},link:function(n,t){t.keyup(function(t){t.keyCode==13&&n.customEnter()})}}}]);